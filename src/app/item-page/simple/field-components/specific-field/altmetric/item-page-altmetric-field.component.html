<div class="item-page-field">
    <ds-metadata-field-wrapper [hideIfNoTextContent]="false">
        <div class="simple-view-element">
            <div class="simple-view-element-body">
                <ng-container [ngTemplateOutlet]="altmetricBadge"
                              [ngTemplateOutletContext]="{
                                                    itemDoi: item?.firstMetadataValue('cg.identifier.doi'),
                                                    itemHandle: item?.firstMetadataValue('dc.identifier.uri'),
                                                  }">
                </ng-container>
            </div>
        </div>
    </ds-metadata-field-wrapper>
</div>

<!-- See: https://badge-docs.altmetric.com/getting-started.html -->
<ng-template #altmetricBadge let-itemDoi="itemDoi" let-itemHandle="itemHandle">
    <!-- Prefer using the Altmetric score for the DOI if it is present -->
    <div *ngIf="itemDoi.length" class="altmetric-embed" data-hide-no-mentions="true" data-badge-type="donut" data-badge-popover="right" data-link-target="_blank" [attr.data-doi]=parseDoi(itemDoi)></div>
    <!-- If not, check the score for the Handle -->
    <div *ngIf="!itemDoi.length" class="altmetric-embed" data-hide-no-mentions="true" data-badge-type="donut" data-badge-popover="right" data-link-target="_blank" [attr.data-handle]=parseHandle(itemHandle)></div>
</ng-template>
